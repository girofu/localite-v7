---
description: 'åŸ·è¡Œä»»å‹™æ¸…å–®ä¸­çš„ä»»å‹™é …ç›®ï¼Œä¸¦ä¸”å¿…é ˆä¾ç…§åŸ·è¡Œä»»å‹™æ–¹å¼çš„æ–¹å¼åŸ·è¡Œï¼ŒåŸ·è¡Œå¾Œæ ¹æ“šç´€éŒ„æ¸…å–®ä¾†ç´€éŒ„é­é‡çš„å•é¡Œèˆ‡ä¿®æ­£æ–¹å¼ã€‚'
globs:
alwaysApply: false
---

# Develop by Task Rule (TDD + Agent-Driven Version)

version: 1.4.0
changeLog:

- 2025-08-24: ğŸ“ ç°¡åŒ–æ–‡æª”å…§å®¹ï¼Œç§»é™¤è©³ç´°ç¨‹å¼ç¢¼æ”¹ç‚ºå¼•ç”¨ç›¸é—œæ–‡ä»¶
- 2025-08-24: ğŸ”§ æ–°å¢ setup-test-templates.sh è…³æœ¬è™•ç†æ¸¬è©¦æ¨¡æ¿é¸æ“‡
- 2025-08-24: ğŸ”„ å„ªåŒ–åŸ·è¡Œæµç¨‹ï¼Œä½¿ç”¨å¼•ç”¨å¼æ¶æ§‹æé«˜å¯ç¶­è­·æ€§
- 2025-08-24: ğŸ§ª æ•´åˆæ¸¬è©¦æ¨¡æ¿èˆ‡ TDD æœ€ä½³å¯¦è¸æ–‡æª”
- 2025-08-24: ğŸ”„ ä¿®æ”¹åŸ·è¡Œæµç¨‹æ”¯æ´è‡ªå‹•æ¸¬è©¦æ¨¡æ¿é¸æ“‡
- 2025-08-24: ğŸ“‹ å¢åŠ æ¸¬è©¦å“è³ªæª¢æŸ¥èˆ‡é©—è­‰æ­¥é©Ÿ
- 2025-08-22: æ–°å¢ Agent Prompts æ•´åˆç³»çµ±
- 2025-08-22: æ–°å¢çµ‚ç«¯æ©ŸæŒ‡ä»¤è¦ç¯„æ–‡ä»¶
- 2025-08-22: æ–°å¢ç’°å¢ƒåƒæ•¸ä½¿ç”¨æ±ºç­–æ¨¹
- 2025-08-15: æ–°å¢ TDD é–‹ç™¼é€±æœŸ
- 2025-08-15: æ–°å¢ç’°å¢ƒè®Šæ•¸é©—è­‰
- 2025-08-15: æ–°å¢ç¨‹å¼ç¢¼å½±éŸ¿åˆ†æ
- 2025-08-15: æ–°å¢æ¸¬è©¦ç’°å¢ƒé…ç½®æŒ‡å—
- 2025-08-15: æ–°å¢æ¸¬è©¦ç­–ç•¥æ±ºç­–
- 2025-08-15: æ–°å¢éŒ¯èª¤è¨˜éŒ„

## åŠŸèƒ½æè¿°

æœ¬è¦å‰‡éµå¾ª**æ¸¬è©¦é©…å‹•é–‹ç™¼ (Test-Driven Development, TDD)** åŸå‰‡ï¼Œä¸¦æ•´åˆ**å°ˆæ¥­ Agent Prompts** è¼”åŠ©ç³»çµ±ã€‚

åŸ·è¡Œ "ä»»å‹™æ¸…å–®" ä¸­çš„ "ä»»å‹™é …ç›®"ï¼Œé€éã€Œç´…-ç¶ -é‡æ§‹ã€çš„é–‹ç™¼é€±æœŸï¼Œå…ˆæ’°å¯«å¤±æ•—çš„æ¸¬è©¦æ¡ˆä¾‹ï¼Œå†æ’°å¯«æœ€ç²¾ç°¡çš„ç¨‹å¼ç¢¼ä½¿å…¶é€šéï¼Œæœ€å¾Œé€²è¡Œé‡æ§‹ï¼Œç¢ºä¿ç¨‹å¼ç¢¼å“è³ªèˆ‡åŠŸèƒ½çš„æ­£ç¢ºæ€§ã€‚é–‹ç™¼éç¨‹ä¸­æ ¹æ“šä¸åŒçµ„ä»¶é¡å‹è‡ªå‹•å¥—ç”¨ç›¸æ‡‰çš„ Agent Prompt æŒ‡å°ã€‚åŸ·è¡Œå¾Œæ ¹æ“š "ç´€éŒ„æ¸…å–®" ä¾†ç´€éŒ„é­é‡çš„å•é¡Œèˆ‡ä¿®æ­£æ–¹å¼ã€‚

## åƒæ•¸èªªæ˜

### 1. ä»»å‹™æ¸…å–® (Task List)

- **ç”¨é€”**: æŒ‡å®šåŒ…å«ä»»å‹™é …ç›®çš„æ¸…å–®æ–‡ä»¶
- **é è¨­å€¼**: `@tasks-localite-prd.mdc`
- **æ ¼å¼**: `@filename.mdc` æˆ– rule æŒ‡ä»¤

### 2. ä»»å‹™é …ç›® (Task Item)

- **ç”¨é€”**: æŒ‡å®šè¦åŸ·è¡Œçš„å…·é«”ä»»å‹™é …æ¬¡
- **é è¨­å€¼**: æ ¹æ“š `@tasks-localite-prd.mdc` çš„æœªå®Œæˆæœ€è¿‘é …ç›®
- **æ ¼å¼**: ä»»å‹™ç·¨è™Ÿ (ä¾‹å¦‚: `2.5.1`, `1.6.2.3`)

### 3. task list ä½¿ç”¨æ–¹æ³• (Task List Usage Method)

- **ç”¨é€”**: æŒ‡å®š task list çš„ä½¿ç”¨æ–¹æ³•
- **é è¨­å€¼**: `@process-task-list.mdc`
- **æ ¼å¼**: `@filename.mdc` æˆ– rule æŒ‡ä»¤

### 4. ç´€éŒ„æ¸…å–®ä½¿ç”¨æ–¹æ³• (Record List Usage Method)

- **ç”¨é€”**: æŒ‡å®šè¨˜éŒ„å•é¡Œèˆ‡ä¿®æ­£æ–¹å¼çš„æ–‡ä»¶ä½¿ç”¨æ–¹æ³•
- **é è¨­å€¼**: `@dev-record-localite-v6.mdc`
- **æ ¼å¼**: `@filename.mdc` æˆ– rule æŒ‡ä»¤

### 5. çµ‚ç«¯æ©ŸæŒ‡ä»¤è¦ç¯„ (Terminal Commands Reference) - æ–°å¢

- **ç”¨é€”**: çµ±ä¸€çš„çµ‚ç«¯æ©ŸæŒ‡ä»¤åŸ·è¡Œè¦ç¯„
- **é è¨­å€¼**: `@terminal-commands.mdc`
- **æ ¼å¼**: å›ºå®šæ–‡ä»¶åƒè€ƒ

### 6. Agent Prompts æ•´åˆç³»çµ± (Agent Prompts Integration System) - æ–°å¢

- **ç”¨é€”**: çµ±ä¸€çš„ Agent Prompts æ•´åˆç³»çµ±
- **é è¨­å€¼**: `@agent-prompts.mdc`
- **æ ¼å¼**: å›ºå®šæ–‡ä»¶åƒè€ƒ

### 7. ç¨‹å¼ç¢¼é¢¨æ ¼ (Coding Style Guide) - æ–°å¢

- **ç”¨é€”**: çµ±ä¸€çš„ç¨‹å¼ç¢¼é¢¨æ ¼æŒ‡å—
- **é è¨­å€¼**: `@coding-style-guide.mdc`
- **æ ¼å¼**: å›ºå®šæ–‡ä»¶åƒè€ƒ

### 8. TDD é–‹ç™¼å¾ªç’° (TDD Development Cycle) - æ–°å¢

- **ç”¨é€”**: çµ±ä¸€çš„ TDD é–‹ç™¼å¾ªç’°æŒ‡å—
- **é è¨­å€¼**: `@tdd-development-rule.mdc`
- **æ ¼å¼**: å›ºå®šæ–‡ä»¶åƒè€ƒ

### 9. å®Œæ•´é–‹ç™¼æ¶æ§‹èˆ‡å¯¦æ–½æŒ‡å— (Full Development Framework and Implementation Guide) - æ–°å¢

- **ç”¨é€”**: çµ±ä¸€çš„å®Œæ•´é–‹ç™¼æ¶æ§‹èˆ‡å¯¦æ–½æŒ‡å—
- **é è¨­å€¼**: `@development-design.mdc`
- **æ ¼å¼**: å›ºå®šæ–‡ä»¶åƒè€ƒ

## ä½¿ç”¨æ–¹å¼

### å®Œæ•´èªæ³•

```
@develop-by-task
1. [ä»»å‹™æ¸…å–®]
2. [ä»»å‹™é …ç›®]
3. [task list ä½¿ç”¨æ–¹æ³•]
4. [ç´€éŒ„æ¸…å–®ä½¿ç”¨æ–¹æ³•]
5. [çµ‚ç«¯æ©ŸæŒ‡ä»¤è¦ç¯„]
6. [Agent Prompts æ•´åˆç³»çµ±]
7. [ç¨‹å¼ç¢¼é¢¨æ ¼]
8. [TDD é–‹ç™¼å¾ªç’°]
9. [å®Œæ•´é–‹ç™¼æ¶æ§‹èˆ‡å¯¦æ–½æŒ‡å—]
```

### ä½¿ç”¨ç¯„ä¾‹

#### ç¯„ä¾‹ 1: é è¨­å€¼

```
@develop-by-task
1. [ä»»å‹™æ¸…å–®] @tasks-localite-prd.mdc
2. [ä»»å‹™é …ç›®] x.x
3. [task list ä½¿ç”¨æ–¹æ³•] @process-task-list.mdc
4. [ç´€éŒ„æ¸…å–®ä½¿ç”¨æ–¹æ³•] @dev-record-localite-v6.mdc
5. [çµ‚ç«¯æ©ŸæŒ‡ä»¤è¦ç¯„] @terminal-commands.mdc
6. [Agent Prompts æ•´åˆç³»çµ±] @agent-prompts.mdc
7. [ç¨‹å¼ç¢¼é¢¨æ ¼] @coding-style-guide.mdc
8. [TDD é–‹ç™¼å¾ªç’°] @tdd-development-rule.mdc
9. [å®Œæ•´é–‹ç™¼æ¶æ§‹èˆ‡å¯¦æ–½æŒ‡å—] @development-design.mdc
```

#### ç¯„ä¾‹ 2: æŒ‡å®šä»»å‹™é …ç›®ï¼Œé è¨­å€¼åƒæ•¸å…¨é¸

```
@develop-by-task
all
x.x
```

#### ç¯„ä¾‹ 2: è‡ªå‹•é¸æ“‡æœªå®Œæˆä»»å‹™ï¼Œæ ¹æ“šæŒ‡å®šä»»å‹™é …ç›®ç”±ç³»çµ±è‡ªå‹•é¸æ“‡åƒæ•¸

```
@develop-by-task
auto
```

#### ç¯„ä¾‹ 3: æ ¹æ“šæŒ‡å®šä»»å‹™é …ç›®ç”±ç³»çµ±è‡ªå‹•é¸æ“‡åƒæ•¸

```
@develop-by-task
auto
x.x
```

## åŸ·è¡Œæµç¨‹

### Phase 1: ä»»å‹™æº–å‚™èˆ‡åˆ†æ

#### 1.1 è®€å–ä»»å‹™æ¸…å–®

```bash
# æŸ¥çœ‹ä»»å‹™æ¸…å–®
cat tasks-localite-prd.mdc | grep -E "^\s*- \[ \]"

# é¸æ“‡ä»»å‹™ï¼ˆè‡ªå‹•æˆ–æ‰‹å‹•ï¼‰
# è‡ªå‹•ï¼šé¸æ“‡æœ€é«˜å„ªå…ˆç´šæœªå®Œæˆä»»å‹™
# æ‰‹å‹•ï¼šæŒ‡å®šä»»å‹™ç·¨è™Ÿï¼ˆå¦‚ 2.5.1ï¼‰
```

#### 1.2 é¸æ“‡å°æ‡‰çš„ Agent Prompt èˆ‡æ¸¬è©¦æ¨¡æ¿

æ ¹æ“šä»»å‹™é¡å‹ï¼Œç³»çµ±è‡ªå‹•è¼‰å…¥å°æ‡‰çš„ Agent Prompt å’Œæ¸¬è©¦æ¨¡æ¿ï¼š

| ä»»å‹™é¡å‹                 | Agent Prompt               | ä¸»è¦æ¸¬è©¦æ¨¡æ¿                                             | é©ç”¨ç¯„åœ               |
| ------------------------ | -------------------------- | -------------------------------------------------------- | ---------------------- |
| Frontend (1.5, 2.5, 3.4) | Frontend Development Agent | `unit-test.template.ts`                                  | React Native, UI å…ƒä»¶  |
| Backend (1.2, 2.2, 3.1)  | Backend Development Agent  | `unit-test.template.ts` + `integration-test.template.ts` | Node.js, API, Services |
| Database (1.3, 2.1, 4.1) | Database Design Agent      | `integration-test.template.ts`                           | MongoDB, Redis, Schema |
| DevOps (6.1, 6.2, 8.0)   | DevOps Engineer Agent      | `integration-test.template.ts` + `e2e-test.template.ts`  | CI/CD, éƒ¨ç½², ç›£æ§      |
| Testing (æ‰€æœ‰ä»»å‹™)       | Testing Specialist Agent   | å…¨éƒ¨æ¨¡æ¿                                                 | æ¸¬è©¦ç­–ç•¥, TDD æŒ‡å°     |

#### 1.2.1 è‡ªå‹•æ¸¬è©¦æ¨¡æ¿é¸æ“‡é‚è¼¯

```bash
# æ ¹æ“šä»»å‹™ç·¨è™Ÿè‡ªå‹•é¸æ“‡æ¸¬è©¦æ¨¡æ¿

# 0.4 æ¶æ§‹è¦ç¯„ â†’ å–®å…ƒæ¸¬è©¦æ¨¡æ¿
if [[ "$task_id" =~ ^0\.4 ]]; then
  template="unit-test.template.ts"
  test_type="unit"
fi

# 1.1 è³‡æ–™åº« â†’ æ•´åˆæ¸¬è©¦æ¨¡æ¿
if [[ "$task_id" =~ ^1\.1 ]]; then
  template="integration-test.template.ts"
  test_type="integration"
fi

# 1.2 API é–‹ç™¼ â†’ å–®å…ƒæ¸¬è©¦ + E2E æ¸¬è©¦
if [[ "$task_id" =~ ^1\.2 ]]; then
  template="unit-test.template.ts integration-test.template.ts"
  test_type="unit integration"
fi

# 3.2 å³æ™‚èŠå¤© â†’ E2E æ¸¬è©¦æ¨¡æ¿
if [[ "$task_id" =~ ^3\.2 ]]; then
  template="e2e-test.template.ts"
  test_type="e2e"
fi
```

#### 1.3 ç’°å¢ƒè®Šæ•¸æª¢æŸ¥èˆ‡é…ç½®

##### ç’°å¢ƒæª”æ¡ˆå°æ‡‰è¡¨

| ç’°å¢ƒ   | é…ç½®æª”æ¡ˆ           | ç”¨é€”       | ä½¿ç”¨æ™‚æ©Ÿ           |
| ------ | ------------------ | ---------- | ------------------ |
| é–‹ç™¼   | `.env.development` | æœ¬åœ°é–‹ç™¼   | æ—¥å¸¸é–‹ç™¼ã€åŠŸèƒ½å¯¦ä½œ |
| æ¸¬è©¦   | `.env.test`        | è‡ªå‹•åŒ–æ¸¬è©¦ | åŸ·è¡Œæ¸¬è©¦å¥—ä»¶       |
| é ç”Ÿç”¢ | `.env.staging`     | é ç™¼å¸ƒæ¸¬è©¦ | åŠŸèƒ½é©—è­‰ã€UAT      |
| ç”Ÿç”¢   | `.env.production`  | æ­£å¼ç’°å¢ƒ   | ç·šä¸Šæœå‹™           |

##### ç’°å¢ƒè®Šæ•¸é©—è­‰è…³æœ¬

```bash
# åŸ·è¡Œç’°å¢ƒæª¢æŸ¥
npm run env:check

# åˆ‡æ›ç’°å¢ƒ
export NODE_ENV=development  # æˆ– test, staging, production
npm run env:load
```

### Phase 2: TDD é–‹ç™¼å¾ªç’° (æ•´åˆæ¸¬è©¦æ¨¡æ¿)

#### ğŸ¯ TDD æ ¸å¿ƒæ¦‚å¿µèˆ‡åŸå‰‡

**Test-Driven Development (TDD)** æ˜¯ä¸€ç¨®è»Ÿé«”é–‹ç™¼æ–¹æ³•è«–ï¼Œéµå¾ªã€Œæ¸¬è©¦å…ˆè¡Œã€çš„æ ¸å¿ƒç†å¿µã€‚TDD ä¸åªæ˜¯æ¸¬è©¦ç­–ç•¥ï¼Œæ›´æ˜¯è¨­è¨ˆèˆ‡é–‹ç™¼çš„æŒ‡å°å“²å­¸ã€‚

è©³ç´°çš„ TDD é–‹ç™¼å¾ªç’°èªªæ˜ï¼Œè«‹åƒè€ƒä»¥ä¸‹æ–‡ä»¶ï¼š

```
@tdd-development-rule.mdc
docs/tdd-guide.md
docs/testing-best-practices.md
```

#### 2.0 æ¸¬è©¦æ¨¡æ¿æº–å‚™èˆ‡åˆå§‹åŒ–

##### 2.0.1 è‡ªå‹•å»ºç«‹æ¸¬è©¦æª”æ¡ˆ

```bash
# åŸ·è¡Œæ¸¬è©¦æ¨¡æ¿è‡ªå‹•é¸æ“‡è…³æœ¬
./scripts/setup-test-templates.sh "$task_id" "$task_name"
```

**è…³æœ¬åŠŸèƒ½èªªæ˜**ï¼š

- æ ¹æ“šä»»å‹™ç·¨è™Ÿè‡ªå‹•é¸æ“‡é©ç•¶çš„æ¸¬è©¦æ¨¡æ¿
- å»ºç«‹å°æ‡‰çš„æ¸¬è©¦æª”æ¡ˆåˆ°æ­£ç¢ºç›®éŒ„
- é¡¯ç¤ºç›¸é—œæ–‡æª”æŒ‡å¼•

**è©³ç´°æ¨¡æ¿é¸æ“‡è¦å‰‡**: åƒè€ƒ `scripts/setup-test-templates.sh`

##### 2.0.2 æ¸¬è©¦æª”æ¡ˆå®¢è£½åŒ–æŒ‡å¼•

**å®¢è£½åŒ–æª¢æŸ¥æ¸…å–®**: åƒè€ƒ `docs/testing-best-practices.md#æ¸¬è©¦æ¨¡æ¿å®¢è£½åŒ–`

**ç›¸é—œæ–‡æª”**:

- ğŸ“˜ **TDD æŒ‡å—**: `docs/tdd-guide.md`
- ğŸ“— **æ¸¬è©¦æœ€ä½³å¯¦è¸**: `docs/testing-best-practices.md`
- ğŸ”§ **Mock å·¥å…·ä½¿ç”¨**: `backend/src/tests/mock-tools/`

### Phase 3: æ•´åˆèˆ‡é©—è­‰ (å«æ¸¬è©¦å“è³ªæª¢æŸ¥)

#### 3.1 åŸ·è¡Œå®Œæ•´æ¸¬è©¦å¥—ä»¶

```bash
# ğŸ§ª åŸ·è¡Œ TDD æ¸¬è©¦å¾ªç’°
echo "ğŸš€ åŸ·è¡Œ TDD æ¸¬è©¦å¾ªç’°..."

# ä½¿ç”¨æ¸¬è©¦è…³æœ¬åŸ·è¡Œå°æ‡‰çš„æ¸¬è©¦
./scripts/setup-test-templates.sh "$task_id" "$task_name" && \
npm run test:coverage
```

**æ¸¬è©¦åŸ·è¡Œç­–ç•¥**ï¼š

- æ ¹æ“šå»ºç«‹çš„æ¸¬è©¦æª”æ¡ˆé¡å‹è‡ªå‹•åŸ·è¡Œå°æ‡‰æ¸¬è©¦
- å–®å…ƒæ¸¬è©¦ã€æ•´åˆæ¸¬è©¦ã€E2E æ¸¬è©¦çš„å…·é«”åŸ·è¡Œæ–¹å¼
- æ¸¬è©¦è¦†è“‹ç‡æª¢æŸ¥

**è©³ç´°æ¸¬è©¦åŸ·è¡ŒæŒ‡ä»¤**: åƒè€ƒ `@terminal-commands.mdc`

#### 3.1.1 æ¸¬è©¦å“è³ªé©—è­‰

```bash
# ğŸ” åŸ·è¡Œæ¸¬è©¦å“è³ªæª¢æŸ¥
./scripts/setup-test-templates.sh "$task_id" "$task_name"
```

**å“è³ªæª¢æŸ¥é …ç›®**: åƒè€ƒ `docs/testing-best-practices.md#æ¸¬è©¦å“è³ªæª¢æŸ¥`

**æª¢æŸ¥å…§å®¹åŒ…å«**ï¼š

- Mock å·¥å…·ä½¿ç”¨æª¢æŸ¥
- AAA æ¨¡å¼éµå¾ªé©—è­‰
- TestDataFactory ä½¿ç”¨å»ºè­°
- æ¸¬è©¦å‘½åè¦ç¯„æª¢æŸ¥

#### 3.2 ç’°å¢ƒé©—è­‰æµç¨‹

**ç’°å¢ƒé…ç½®æŒ‡å¼•**: åƒè€ƒ `@terminal-commands.mdc` å’Œç’°å¢ƒè®Šæ•¸ä½¿ç”¨æ±ºç­–æ¨¹

##### Mock æ¸¬è©¦ vs æ•´åˆæ¸¬è©¦æ±ºç­–çŸ©é™£

| æ¸¬è©¦é¡å‹   | ä½¿ç”¨ Mock | ä½¿ç”¨çœŸå¯¦æœå‹™ | ç’°å¢ƒéœ€æ±‚          |
| ---------- | --------- | ------------ | ----------------- |
| æ¥­å‹™é‚è¼¯   | âœ…        | âŒ           | ç„¡                |
| å·¥å…·å‡½æ•¸   | âœ…        | âŒ           | ç„¡                |
| å¤–éƒ¨ API   | âŒ        | âœ…           | `.env.test`       |
| è³‡æ–™åº«æ“ä½œ | éƒ¨åˆ†      | âœ…           | æ¸¬è©¦è³‡æ–™åº«        |
| èªè­‰æµç¨‹   | âŒ        | âœ…           | Firebase æ¸¬è©¦å°ˆæ¡ˆ |

**è©³ç´°ç’°å¢ƒé…ç½®**: åƒè€ƒæ–‡ä»¶ä¸­çš„ã€Œç’°å¢ƒåƒæ•¸ä½¿ç”¨æ±ºç­–æ¨¹ã€ç« ç¯€

### Phase 4: æäº¤èˆ‡éƒ¨ç½² (å«æ¸¬è©¦é©—è­‰)

#### 4.1 ç¨‹å¼ç¢¼èˆ‡æ¸¬è©¦æª¢æŸ¥

```bash
# ğŸ” åŸ·è¡Œå®Œæ•´ç¨‹å¼ç¢¼å“è³ªæª¢æŸ¥
npm run type-check && npm run lint && npm run format

# ğŸ§ª åŸ·è¡Œæœ€çµ‚æ¸¬è©¦é©—è­‰ä¸¦æª¢æŸ¥è¦†è“‹ç‡é–€æª»
npm test && npm run test:coverage
```

**æª¢æŸ¥é …ç›®**:

- TypeScript é¡å‹æª¢æŸ¥
- ESLint ç¨‹å¼ç¢¼æª¢æŸ¥ï¼ˆåŒ…å«æ¸¬è©¦æª”æ¡ˆï¼‰
- Prettier æ ¼å¼åŒ–
- æ¸¬è©¦è¦†è“‹ç‡é–€æª»é©—è­‰ï¼ˆâ‰¥85%ï¼‰

**è©³ç´°æŒ‡ä»¤èªªæ˜**: åƒè€ƒ `@terminal-commands.mdc`

#### 4.2 Git æäº¤æµç¨‹

```bash
# ğŸ—‚ï¸ æäº¤ï¼ˆéµå¾ª Conventional Commits + æ¸¬è©¦è³‡è¨Šï¼‰
git add .
git commit -m "feat(${task_name}): implement ${task_description} with TDD"
```

**æäº¤è¨Šæ¯è¦ç¯„**: åƒè€ƒ `@coding-style-guide.mdc#æäº¤è¨Šæ¯è¦ç¯„`

#### 4.2.1 æäº¤å‰æª¢æŸ¥æ¸…å–®

**å®Œæ•´æª¢æŸ¥æ¸…å–®**: åƒè€ƒ `docs/testing-best-practices.md#æäº¤å‰æª¢æŸ¥æ¸…å–®`

**æ ¸å¿ƒæª¢æŸ¥é …ç›®**:

- âœ… æ–°åŠŸèƒ½æœ‰å°æ‡‰æ¸¬è©¦æª”æ¡ˆ
- âœ… æ¸¬è©¦è¦†è“‹ç‡ â‰¥ 85%
- âœ… æ‰€æœ‰æ¸¬è©¦é€šé
- âœ… ç¨‹å¼ç¢¼é€šé lint æª¢æŸ¥

#### 4.3 åŠŸèƒ½æ——æ¨™é…ç½®

**åŠŸèƒ½æ——æ¨™ä½¿ç”¨è¦ç¯„**: åƒè€ƒ `@development-design.mdc#åŠŸèƒ½æ——æ¨™ç­–ç•¥`

**æ ¸å¿ƒåŸå‰‡**:

- æ–°åŠŸèƒ½å¿…é ˆåŒ…è£¹åœ¨åŠŸèƒ½æ——æ¨™ä¸­
- æ”¯æ´é‡‘çµ²é›€éƒ¨ç½²å’Œæ¼¸é€²å¼ç™¼å¸ƒ
- ç¨‹å¼ç¢¼ç¯„ä¾‹åƒè€ƒé–‹ç™¼è¨­è¨ˆæ–‡æª”

## ğŸŒ ç’°å¢ƒåƒæ•¸ä½¿ç”¨æ±ºç­–æ¨¹ (æ–°å¢)

### ç’°å¢ƒåƒæ•¸é¸æ“‡é‚è¼¯

æ ¹æ“šä¸åŒçš„é–‹ç™¼éšæ®µå’Œæ¸¬è©¦éœ€æ±‚ï¼Œä½¿ç”¨å°æ‡‰çš„ç’°å¢ƒåƒæ•¸ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   é–‹å§‹é–‹ç™¼ä»»å‹™      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ä»»å‹™é¡å‹åˆ¤æ–·       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚             â”‚         â”‚          â”‚           â”‚
    â–¼             â–¼         â–¼          â–¼           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚æœ¬åœ°é–‹ç™¼â”‚  â”‚å–®å…ƒæ¸¬è©¦â”‚  â”‚æ•´åˆæ¸¬è©¦â”‚  â”‚E2Eæ¸¬è©¦ â”‚  â”‚éƒ¨ç½²    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚           â”‚           â”‚           â”‚           â”‚
    â–¼           â–¼           â–¼           â–¼           â–¼
   .env     ä¸éœ€è¦      .env.test   .env.e2e   .env.[ç’°å¢ƒ]
            ç’°å¢ƒåƒæ•¸
```

### ç’°å¢ƒåƒæ•¸é…ç½®è¡¨

| é–‹ç™¼éšæ®µ     | ç’°å¢ƒæª”æ¡ˆ          | ç”¨é€”         | èªªæ˜                          |
| ------------ | ----------------- | ------------ | ----------------------------- |
| **æœ¬åœ°é–‹ç™¼** | `.env`            | æœ¬åœ°é–‹ç™¼ç’°å¢ƒ | ä½¿ç”¨æœ¬åœ°æœå‹™å’Œè³‡æ–™åº«          |
| **å–®å…ƒæ¸¬è©¦** | ç„¡éœ€ç’°å¢ƒæª”        | éš”é›¢æ¸¬è©¦     | å…¨éƒ¨ä½¿ç”¨ Mockï¼Œä¸ä¾è³´å¤–éƒ¨æœå‹™ |
| **æ•´åˆæ¸¬è©¦** | `.env.test`       | çœŸå¯¦æœå‹™æ¸¬è©¦ | ä½¿ç”¨æ¸¬è©¦è³‡æ–™åº«å’Œ API Keys     |
| **E2E æ¸¬è©¦** | `.env.e2e`        | ç«¯å°ç«¯æ¸¬è©¦   | å®Œæ•´æ¸¬è©¦ç’°å¢ƒé…ç½®              |
| **é ç”Ÿç”¢**   | `.env.staging`    | é ç”Ÿç”¢ç’°å¢ƒ   | åŠŸèƒ½æ——æ¨™å’Œç›£æ§é–‹å•Ÿ            |
| **ç”Ÿç”¢**     | `.env.production` | æ­£å¼ç’°å¢ƒ     | ç”Ÿç”¢è³‡æ–™åº«å’Œå®Œæ•´ç›£æ§          |

### ç’°å¢ƒåƒæ•¸ä½¿ç”¨åŸå‰‡

**è©³ç´°é…ç½®ç¯„ä¾‹**: åƒè€ƒ `docs/testing-best-practices.md#ç’°å¢ƒé…ç½®`

**ç’°å¢ƒåˆ‡æ›æŒ‡ä»¤**: åƒè€ƒ `@terminal-commands.mdc#ç’°å¢ƒåˆ‡æ›`

**æ ¸å¿ƒåŸå‰‡**:

- å–®å…ƒæ¸¬è©¦ä½¿ç”¨ Mockï¼Œç„¡éœ€ç’°å¢ƒè®Šæ•¸
- æ•´åˆæ¸¬è©¦ä½¿ç”¨çœŸå¯¦æœå‹™å’Œæ¸¬è©¦ç’°å¢ƒè®Šæ•¸
- ä¸åŒç’°å¢ƒä½¿ç”¨å°æ‡‰çš„ `.env` æª”æ¡ˆ

## è‡ªå‹•ä»»å‹™é¸æ“‡é‚è¼¯

ç•¶æœªæŒ‡å®šä»»å‹™é …ç›®æ™‚ï¼Œç³»çµ±å°‡è‡ªå‹•é¸æ“‡ï¼š

1. æŸ¥æ‰¾ä»»å‹™æ¸…å–®ä¸­æ‰€æœ‰æœªå®Œæˆçš„ä»»å‹™ (`[ ]`)
2. æ ¹æ“š MVP å„ªå…ˆç´šé¸æ“‡æœ€é‡è¦çš„ä»»å‹™
3. è€ƒæ…®ä»»å‹™ä¾è³´é—œä¿‚ï¼Œç¢ºä¿å‰ç½®ä»»å‹™å·²å®Œæˆ
4. å„ªå…ˆé¸æ“‡å¯å¹³è¡ŒåŸ·è¡Œçš„ä»»å‹™
5. é¸æ“‡å±¤ç´šæœ€æ·±çš„æœªå®Œæˆä»»å‹™ï¼ˆå­ä»»å‹™å„ªå…ˆï¼‰
6. å¦‚æœåŒå±¤ç´šæœ‰å¤šå€‹æœªå®Œæˆä»»å‹™ï¼Œé¸æ“‡ç·¨è™Ÿæœ€å°çš„

## æ³¨æ„äº‹é …

1. **Agent è¼”åŠ©é–‹ç™¼**: è®“ Agent Prompt æŒ‡å°ä½ é¿å…éåº¦è¨­è¨ˆå’Œä¸å¿…è¦çš„æ¸¬è©¦
2. **ç’°å¢ƒåƒæ•¸é¸æ“‡**: åš´æ ¼æŒ‰ç…§æ±ºç­–æ¨¹é¸æ“‡æ­£ç¢ºçš„ç’°å¢ƒæª”æ¡ˆ
3. **çµ‚ç«¯æ©Ÿè¦ç¯„**: æ‰€æœ‰æŒ‡ä»¤åŸ·è¡Œå¿…é ˆéµå¾ªæ¨™æº–åŒ–æŒ‡ä»¤é›†
4. **æ¸¬è©¦å…ˆè¡Œ**: åš´æ ¼éµå®ˆå…ˆå¯«æ¸¬è©¦å†å¯«ç¨‹å¼ç¢¼çš„åŸå‰‡
5. **å°æ­¥å‰é€²**: æ¯æ¬¡åªå¯«ä¸€å€‹å¤±æ•—çš„æ¸¬è©¦ï¼Œé¿å…æ‰¹é‡é–‹ç™¼
6. **é‡æ§‹å‹¿å¿˜**: ã€Œç´…-ç¶ ã€ä¹‹å¾Œå¿…é ˆé€²è¡Œé‡æ§‹
7. **ä¿¡ä»»æ¸¬è©¦**: åªè¦æ¸¬è©¦é€šéå°±æœ‰ä¿¡å¿ƒé‡æ§‹
8. **é¿å…éåº¦**: Agent æœƒæé†’é¿å…éåº¦å·¥ç¨‹å’Œéåº¦æ¸¬è©¦

## ğŸ§ª æ¸¬è©¦æ¨¡æ¿ä½¿ç”¨æŒ‡å—

### ğŸ“ æ¸¬è©¦æ¨¡æ¿æ¦‚è¦½

| æ¨¡æ¿æª”æ¡ˆ                       | é©ç”¨å ´æ™¯ | ä¸»è¦åŠŸèƒ½           | å»ºè­°ä½¿ç”¨æ™‚æ©Ÿ                   |
| ------------------------------ | -------- | ------------------ | ------------------------------ |
| `unit-test.template.ts`        | å–®å…ƒæ¸¬è©¦ | æ¸¬è©¦å–®ä¸€å‡½æ•¸æˆ–é¡åˆ¥ | 0.4 æ¶æ§‹è¦ç¯„ã€1.2 API é–‹ç™¼     |
| `integration-test.template.ts` | æ•´åˆæ¸¬è©¦ | æ¸¬è©¦å¤šçµ„ä»¶å”ä½œ     | 1.1 è³‡æ–™åº«è¨­ç½®ã€2.1 èªè­‰æ•´åˆ   |
| `e2e-test.template.ts`         | E2E æ¸¬è©¦ | æ¸¬è©¦å®Œæ•´æ¥­å‹™æµç¨‹   | 1.2 API å®Œæ•´æµç¨‹ã€3.2 å³æ™‚èŠå¤© |

### ğŸ”§ æ¸¬è©¦å·¥å…·é€ŸæŸ¥è¡¨

#### Mock å·¥å…· (`@tests/mock-tools`)

**è©³ç´°ä½¿ç”¨ç¯„ä¾‹**: åƒè€ƒ `backend/src/tests/mock-tools/index.ts`

**ä¸»è¦åŠŸèƒ½**:

- Mock Repository å¿«é€Ÿå»ºç«‹
- è‡ªè¨‚ Mock Service å·¥å» 
- TestDataFactory æ¸¬è©¦è³‡æ–™ç”¢ç”Ÿå™¨
- MockManager ç”Ÿå‘½é€±æœŸç®¡ç†

### ğŸ“Š æ¸¬è©¦è¦†è“‹ç‡è¦æ±‚

| æŒ‡æ¨™       | æœ€ä½è¦æ±‚ | å»ºè­°ç›®æ¨™ | æª¢æŸ¥æŒ‡ä»¤                |
| ---------- | -------- | -------- | ----------------------- |
| èªå¥è¦†è“‹ç‡ | 85%      | 90%+     | `npm run test:coverage` |
| åˆ†æ”¯è¦†è“‹ç‡ | 80%      | 85%+     | `npm run test:coverage` |
| å‡½æ•¸è¦†è“‹ç‡ | 85%      | 90%+     | `npm run test:coverage` |
| è¡Œæ•¸è¦†è“‹ç‡ | 85%      | 90%+     | `npm run test:coverage` |

### ğŸ“– ç›¸é—œæ–‡æª”å¿«é€Ÿé€£çµ

- ğŸ“˜ **å®Œæ•´ TDD æŒ‡å—**: `docs/tdd-guide.md`
- ğŸ“— **æ¸¬è©¦æœ€ä½³å¯¦è¸**: `docs/testing-best-practices.md`
- ğŸ”§ **Mock å·¥å…·æ–‡æª”**: `backend/src/tests/mock-tools/index.ts`
- ğŸ“‹ **æ¸¬è©¦æ¨¡æ¿ç›®éŒ„**: `backend/src/tests/templates/`

## èˆ‡å…¶ä»– Rule çš„é—œè¯

### æ ¸å¿ƒä¾è³´

- **åŸ·è¡Œæµç¨‹**: `@process-task-list.mdc` - ä»»å‹™åŸ·è¡Œæµç¨‹è¦ç¯„
- **çµ‚ç«¯æŒ‡ä»¤**: `@terminal-commands.mdc` - çµ‚ç«¯æ©ŸæŒ‡ä»¤è¦ç¯„
- **é–‹ç™¼è¨­è¨ˆ**: `@development-design.mdc` - å®Œæ•´é–‹ç™¼æ¶æ§‹æŒ‡å—
- **ç¨‹å¼ç¢¼é¢¨æ ¼**: `@coding-style-guide.mdc` - ç·¨ç¢¼æ¨™æº–å’Œæäº¤è¦ç¯„

### æ¸¬è©¦ç›¸é—œä¾è³´ (æ–°å¢)

- **TDD æŒ‡å—**: `docs/tdd-guide.md` - TDD é–‹ç™¼å®Œæ•´æŒ‡å—
- **æ¸¬è©¦æœ€ä½³å¯¦è¸**: `docs/testing-best-practices.md` - æ¸¬è©¦æœ€ä½³å¯¦è¸æ–‡æª”
- **æ¸¬è©¦æ¨¡æ¿åº«**: `backend/src/tests/templates/` - å–®å…ƒ/æ•´åˆ/E2E æ¸¬è©¦æ¨¡æ¿
- **Mock å·¥å…·**: `backend/src/tests/mock-tools/` - çµ±ä¸€çš„ Mock å’Œæ¸¬è©¦å·¥å…·
- **æ¸¬è©¦è…³æœ¬**: `scripts/setup-test-templates.sh` - è‡ªå‹•æ¸¬è©¦æ¨¡æ¿é¸æ“‡è…³æœ¬

### è¼¸å…¥è¼¸å‡º

- **è¼¸å…¥**: `@tasks-localite-prd.mdc` - é …ç›®ä»»å‹™æ¸…å–®
- **è¼¸å‡º**: `@dev-record.mdc` - å•é¡Œè¨˜éŒ„å’Œç¶“é©—åˆ†äº«

### å¤–éƒ¨æ•´åˆ

- **Agent æŒ‡å°**: Agent Prompts Library - å°ˆæ¥­é–‹ç™¼æŒ‡å°
- **æœå‹™æ•´åˆ**: Firebase Authentication, MongoDB, Redis, åŠŸèƒ½æ——æ¨™æœå‹™
