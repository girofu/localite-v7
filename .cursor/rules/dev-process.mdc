---
alwaysApply: false
---
# çµ±ä¸€é–‹ç™¼æµç¨‹æŒ‡å— - TDD + Agent Prompts æ•´åˆç‰ˆ

Version: 2.0.0
Last Updated: 2025-08-22

## ğŸ“‹ æ ¸å¿ƒåŸå‰‡

### 1. Test-Driven Development (TDD)
- **ç´…-ç¶ -é‡æ§‹å¾ªç’°**ï¼šå…ˆå¯«å¤±æ•—æ¸¬è©¦ â†’ å¯¦ä½œæœ€å°ç¨‹å¼ç¢¼ â†’ é‡æ§‹å„ªåŒ–
- **æ¸¬è©¦è¦†è“‹ç‡ç›®æ¨™**ï¼šå–®å…ƒæ¸¬è©¦ >80%ï¼Œæ•´åˆæ¸¬è©¦ >70%
- **é¿å…éåº¦è¨­è¨ˆ**ï¼šåªå¯«é€šéæ¸¬è©¦æ‰€éœ€çš„æœ€å°‘ç¨‹å¼ç¢¼

### 2. Agent-Driven Development
- æ ¹æ“šä¸åŒçµ„ä»¶è‡ªå‹•å¥—ç”¨å°æ‡‰çš„ System Agent Prompt
- ç¢ºä¿ç¨‹å¼ç¢¼é¢¨æ ¼å’Œæ¶æ§‹ä¸€è‡´æ€§
- æä¾›æ™ºèƒ½åŒ–é–‹ç™¼å»ºè­°

### 3. ç’°å¢ƒç®¡ç†åŸå‰‡
- åš´æ ¼å€åˆ†é–‹ç™¼ã€æ¸¬è©¦ã€é ç”Ÿç”¢ã€ç”Ÿç”¢ç’°å¢ƒ
- ä½¿ç”¨åŠŸèƒ½æ——æ¨™æ§åˆ¶åŠŸèƒ½ç™¼å¸ƒ
- ç’°å¢ƒè®Šæ•¸é›†ä¸­ç®¡ç†

## ğŸš€ ä»»å‹™åŸ·è¡Œä¸»æµç¨‹

### Phase 1: ä»»å‹™æº–å‚™èˆ‡åˆ†æ

#### 1.1 è®€å–ä»»å‹™æ¸…å–®
```bash
# æŸ¥çœ‹ä»»å‹™æ¸…å–®
cat tasks-localite-prd.mdc | grep -E "^\s*- \[ \]"

# é¸æ“‡ä»»å‹™ï¼ˆè‡ªå‹•æˆ–æ‰‹å‹•ï¼‰
# è‡ªå‹•ï¼šé¸æ“‡æœ€é«˜å„ªå…ˆç´šæœªå®Œæˆä»»å‹™
# æ‰‹å‹•ï¼šæŒ‡å®šä»»å‹™ç·¨è™Ÿï¼ˆå¦‚ 2.5.1ï¼‰
```

#### 1.2 é¸æ“‡å°æ‡‰çš„ Agent Prompt
æ ¹æ“šä»»å‹™é¡å‹ï¼Œç³»çµ±è‡ªå‹•è¼‰å…¥å°æ‡‰çš„ Agent Promptï¼š

| ä»»å‹™é¡å‹ | Agent Prompt | é©ç”¨ç¯„åœ |
|---------|--------------|---------|
| Frontend (1.5, 2.5, 3.4) | Frontend Development Agent | React Native, UI å…ƒä»¶ |
| Backend (1.2, 2.2, 3.1) | Backend Development Agent | Node.js, API, Services |
| Database (1.3, 2.1, 4.1) | Database Design Agent | MongoDB, Redis, Schema |
| DevOps (6.1, 6.2, 8.0) | DevOps Engineer Agent | CI/CD, éƒ¨ç½², ç›£æ§ |
| Testing (æ‰€æœ‰ä»»å‹™) | Testing Specialist Agent | æ¸¬è©¦ç­–ç•¥, TDD æŒ‡å° |

#### 1.3 ç’°å¢ƒè®Šæ•¸æª¢æŸ¥èˆ‡é…ç½®

##### ç’°å¢ƒæª”æ¡ˆå°æ‡‰è¡¨

| ç’°å¢ƒ | é…ç½®æª”æ¡ˆ | ç”¨é€” | ä½¿ç”¨æ™‚æ©Ÿ |
|-----|---------|------|---------|
| é–‹ç™¼ | `.env.development` | æœ¬åœ°é–‹ç™¼ | æ—¥å¸¸é–‹ç™¼ã€åŠŸèƒ½å¯¦ä½œ |
| æ¸¬è©¦ | `.env.test` | è‡ªå‹•åŒ–æ¸¬è©¦ | åŸ·è¡Œæ¸¬è©¦å¥—ä»¶ |
| é ç”Ÿç”¢ | `.env.staging` | é ç™¼å¸ƒæ¸¬è©¦ | åŠŸèƒ½é©—è­‰ã€UAT |
| ç”Ÿç”¢ | `.env.production` | æ­£å¼ç’°å¢ƒ | ç·šä¸Šæœå‹™ |

##### ç’°å¢ƒè®Šæ•¸é©—è­‰è…³æœ¬
```bash
# åŸ·è¡Œç’°å¢ƒæª¢æŸ¥
npm run env:check

# åˆ‡æ›ç’°å¢ƒ
export NODE_ENV=development  # æˆ– test, staging, production
npm run env:load
```

### Phase 2: TDD é–‹ç™¼å¾ªç’°

#### 2.1 ğŸ”´ ç´…è‰²éšæ®µï¼šæ’°å¯«å¤±æ•—æ¸¬è©¦

**Agent Prompt å•Ÿå‹•**ï¼šTesting Specialist Agent
```typescript
// ç¯„ä¾‹ï¼šç‚ºæ–°åŠŸèƒ½æ’°å¯«æ¸¬è©¦
describe('TourService', () => {
  it('should create a new tour with AI content', async () => {
    const result = await tourService.createTour({ 
      title: 'Test Tour' 
    });
    expect(result).toHaveProperty('id');
    expect(result.aiContent).toBeDefined();
  });
});
```

**åŸ·è¡Œæ¸¬è©¦ç¢ºèªå¤±æ•—**ï¼š
```bash
npm test -- --testNamePattern="should create a new tour"
# é æœŸçµæœï¼šâŒ Test Failed
```

#### 2.2 ğŸŸ¢ ç¶ è‰²éšæ®µï¼šå¯¦ä½œæœ€å°ç¨‹å¼ç¢¼

**Agent Prompt åˆ‡æ›**ï¼šæ ¹æ“šå¯¦ä½œå…§å®¹é¸æ“‡
- Frontend: Frontend Development Agent
- Backend: Backend Development Agent
- Database: Database Design Agent

```typescript
// æœ€å°å¯¦ä½œç¯„ä¾‹
class TourService {
  async createTour(data: CreateTourDto): Promise<Tour> {
    const tour = new Tour();
    tour.id = generateId();
    tour.title = data.title;
    tour.aiContent = await this.aiService.generateContent(data.title);
    return tour;
  }
}
```

**åŸ·è¡Œæ¸¬è©¦ç¢ºèªé€šé**ï¼š
```bash
npm test -- --testNamePattern="should create a new tour"
# é æœŸçµæœï¼šâœ… Test Passed
```

#### 2.3 ğŸ”µ é‡æ§‹éšæ®µï¼šå„ªåŒ–ç¨‹å¼ç¢¼

**Agent Prompt å”åŠ©**ï¼šå°æ‡‰é ˜åŸŸçš„ Agent + Testing Specialist
```typescript
// é‡æ§‹å¾Œçš„ç¨‹å¼ç¢¼
class TourService {
  constructor(
    private readonly tourRepository: ITourRepository,
    private readonly aiService: IAIService,
    private readonly cacheService: ICacheService
  ) {}

  async createTour(data: CreateTourDto): Promise<Tour> {
    // æ”¹å–„ï¼šä¾è³´æ³¨å…¥ã€éŒ¯èª¤è™•ç†ã€å¿«å–
    try {
      const tour = await this.tourRepository.create({
        ...data,
        id: generateId(),
        createdAt: new Date()
      });
      
      const aiContent = await this.generateAIContent(tour);
      tour.aiContent = aiContent;
      
      await this.cacheService.set(`tour:${tour.id}`, tour);
      return tour;
    } catch (error) {
      throw new TourCreationError(error.message);
    }
  }
  
  private async generateAIContent(tour: Tour): Promise<string> {
    // æŠ½å–çš„ç§æœ‰æ–¹æ³•
    return this.aiService.generateContent(tour.title);
  }
}
```

**ç¢ºä¿æ‰€æœ‰æ¸¬è©¦ä»ç„¶é€šé**ï¼š
```bash
npm test
# é æœŸçµæœï¼šAll tests passed
```

### Phase 3: æ•´åˆèˆ‡é©—è­‰

#### 3.1 åŸ·è¡Œå®Œæ•´æ¸¬è©¦å¥—ä»¶

```bash
# å–®å…ƒæ¸¬è©¦
npm run test:unit

# æ•´åˆæ¸¬è©¦ï¼ˆéœ€è¦çœŸå¯¦ç’°å¢ƒè®Šæ•¸ï¼‰
NODE_ENV=test npm run test:integration

# E2E æ¸¬è©¦
npm run test:e2e

# æ¸¬è©¦è¦†è“‹ç‡
npm run test:coverage
```

#### 3.2 ç’°å¢ƒé©—è­‰æµç¨‹

##### Mock æ¸¬è©¦ vs æ•´åˆæ¸¬è©¦æ±ºç­–çŸ©é™£

| æ¸¬è©¦é¡å‹ | ä½¿ç”¨ Mock | ä½¿ç”¨çœŸå¯¦æœå‹™ | ç’°å¢ƒéœ€æ±‚ |
|---------|----------|------------|---------|
| æ¥­å‹™é‚è¼¯ | âœ… | âŒ | ç„¡ |
| å·¥å…·å‡½æ•¸ | âœ… | âŒ | ç„¡ |
| å¤–éƒ¨ API | âŒ | âœ… | `.env.test` |
| è³‡æ–™åº«æ“ä½œ | éƒ¨åˆ† | âœ… | æ¸¬è©¦è³‡æ–™åº« |
| èªè­‰æµç¨‹ | âŒ | âœ… | Firebase æ¸¬è©¦å°ˆæ¡ˆ |

### Phase 4: æäº¤èˆ‡éƒ¨ç½²

#### 4.1 ç¨‹å¼ç¢¼æª¢æŸ¥

```bash
# TypeScript é¡å‹æª¢æŸ¥
npm run type-check

# ESLint æª¢æŸ¥ï¼ˆåªä¿®å¾©ç•¶å‰ä»»å‹™ç›¸é—œï¼‰
npm run lint -- --fix src/current-feature/

# Prettier æ ¼å¼åŒ–
npm run format
```

#### 4.2 Git æäº¤æµç¨‹

```bash
# æš«å­˜è®Šæ›´
git add .

# æäº¤ï¼ˆéµå¾ª Conventional Commitsï¼‰
git commit -m "feat(tour): implement AI tour creation with TDD" \
           -m "- Added TourService with AI content generation" \
           -m "- Implemented caching strategy" \
           -m "- Test coverage: 85%" \
           -m "Task: 3.2.1 from tasks-localite-prd.mdc"
```

#### 4.3 åŠŸèƒ½æ——æ¨™é…ç½®

```typescript
// æ–°åŠŸèƒ½å¿…é ˆåŒ…è£¹åœ¨åŠŸèƒ½æ——æ¨™ä¸­
if (featureFlags.isEnabled('ai-tour-creation', userId)) {
  // æ–°åŠŸèƒ½ç¨‹å¼ç¢¼
  return await tourService.createTourWithAI(data);
} else {
  // èˆŠç‰ˆæœ¬é‚è¼¯
  return await tourService.createTour(data);
}
```

## ğŸ¤– System Agent Prompts ä½¿ç”¨æŒ‡å—

### Frontend Development Agent
**è§¸ç™¼æ¢ä»¶**ï¼šè™•ç† React Nativeã€UI å…ƒä»¶ã€å‰ç«¯ç‹€æ…‹ç®¡ç†
```markdown
Context: React Native + TypeScript é–‹ç™¼
Principles:
- ä½¿ç”¨å‡½æ•¸å¼å…ƒä»¶å’Œ Hooks
- å¯¦ä½œæœ¬åœ°å„ªå…ˆç­–ç•¥
- ç¢ºä¿é›¢ç·šå¯ç”¨æ€§
- éµå¾ª MVC æ¨¡å¼ï¼ˆView å±¤ï¼‰
```

### Backend Development Agent
**è§¸ç™¼æ¢ä»¶**ï¼šè™•ç† Node.jsã€APIã€å¾Œç«¯æœå‹™
```markdown
Context: Node.js + Express + TypeScript
Principles:
- RESTful API è¨­è¨ˆ
- WebSocket å¯¦æ™‚é€šè¨Š
- ä¾è³´æ³¨å…¥æ¨¡å¼
- éŒ¯èª¤è™•ç†å®Œæ•´æ€§
```

### Database Design Agent
**è§¸ç™¼æ¢ä»¶**ï¼šè™•ç†è³‡æ–™åº«è¨­è¨ˆã€Schemaã€æŸ¥è©¢å„ªåŒ–
```markdown
Context: MongoDB + Redis + æœ¬åœ°è³‡æ–™åº«
Principles:
- æ­£è¦åŒ– vs åæ­£è¦åŒ–æ¬Šè¡¡
- é›¢ç·šåŒæ­¥æ©Ÿåˆ¶
- ç´¢å¼•å„ªåŒ–ç­–ç•¥
- è³‡æ–™è¡çªè§£æ±º
```

### DevOps Engineer Agent
**è§¸ç™¼æ¢ä»¶**ï¼šè™•ç† CI/CDã€éƒ¨ç½²ã€ç›£æ§
```markdown
Context: Docker + Kubernetes + GitHub Actions
Principles:
- é‡‘çµ²é›€éƒ¨ç½²ç­–ç•¥
- åŠŸèƒ½æ——æ¨™ç®¡ç†
- é›¶åœæ©Ÿéƒ¨ç½²
- è‡ªå‹•å›æ»¾æ©Ÿåˆ¶
```

### Testing Specialist Agent
**è§¸ç™¼æ¢ä»¶**ï¼šæ‰€æœ‰æ¸¬è©¦ç›¸é—œä»»å‹™
```markdown
Context: Jest + TDD æ–¹æ³•è«–
Principles:
- ç´…-ç¶ -é‡æ§‹å¾ªç’°
- æ¸¬è©¦å„ªå…ˆé–‹ç™¼
- è¦†è“‹ç‡ >80%
- Mock vs æ•´åˆæ¸¬è©¦æ±ºç­–
```

## ğŸ“ çµ‚ç«¯æ©ŸæŒ‡ä»¤é€ŸæŸ¥è¡¨

### é–‹ç™¼å¸¸ç”¨æŒ‡ä»¤
```bash
# ç’°å¢ƒç®¡ç†
npm run env:check          # æª¢æŸ¥ç’°å¢ƒè®Šæ•¸
npm run env:load           # è¼‰å…¥ç•¶å‰ç’°å¢ƒè®Šæ•¸

# é–‹ç™¼ä¼ºæœå™¨
npm run dev                # å•Ÿå‹•é–‹ç™¼ä¼ºæœå™¨
npm run dev:mobile         # å•Ÿå‹• React Native Metro

# æ¸¬è©¦æŒ‡ä»¤
npm test                   # åŸ·è¡Œæ‰€æœ‰æ¸¬è©¦
npm run test:unit         # åªåŸ·è¡Œå–®å…ƒæ¸¬è©¦
npm run test:integration  # åªåŸ·è¡Œæ•´åˆæ¸¬è©¦
npm run test:watch        # ç›£è½æ¨¡å¼
npm run test:coverage     # æ¸¬è©¦è¦†è“‹ç‡

# ç¨‹å¼ç¢¼å“è³ª
npm run lint              # ESLint æª¢æŸ¥
npm run lint:fix          # è‡ªå‹•ä¿®å¾©
npm run format            # Prettier æ ¼å¼åŒ–
npm run type-check        # TypeScript æª¢æŸ¥

# å»ºç½®èˆ‡éƒ¨ç½²
npm run build             # ç”Ÿç”¢ç’°å¢ƒå»ºç½®
npm run build:android     # Android APK
npm run build:ios         # iOS IPA
npm run deploy:canary     # é‡‘çµ²é›€éƒ¨ç½²
npm run deploy:prod       # ç”Ÿç”¢ç’°å¢ƒéƒ¨ç½²
```

### Git å·¥ä½œæµç¨‹
```bash
# åŠŸèƒ½é–‹ç™¼
git checkout -b feature/task-x-x-x
git add .
git commit -m "feat: [description]"
git push origin feature/task-x-x-x

# ç¨‹å¼ç¢¼å¯©æŸ¥
git fetch origin
git checkout -b review/pr-xxx origin/pr-xxx
npm test
npm run lint

# åˆä½µä¸»å¹¹
git checkout main
git pull origin main
git merge --no-ff feature/task-x-x-x
git push origin main
```

## ğŸ“Š ä»»å‹™å®Œæˆæª¢æŸ¥æ¸…å–®

- [ ] **TDD å¾ªç’°å®Œæˆ**
  - [ ] æ‰€æœ‰æ¸¬è©¦æ¡ˆä¾‹æ’°å¯«å®Œæˆ
  - [ ] ç¨‹å¼ç¢¼é€šéæ‰€æœ‰æ¸¬è©¦
  - [ ] å®Œæˆå¿…è¦çš„é‡æ§‹
  
- [ ] **ç¨‹å¼ç¢¼å“è³ª**
  - [ ] TypeScript ç„¡é¡å‹éŒ¯èª¤
  - [ ] ESLint ç„¡ç›¸é—œéŒ¯èª¤
  - [ ] æ¸¬è©¦è¦†è“‹ç‡é”æ¨™ï¼ˆ>80%ï¼‰
  
- [ ] **ç’°å¢ƒé©—è­‰**
  - [ ] é–‹ç™¼ç’°å¢ƒæ¸¬è©¦é€šé
  - [ ] æ¸¬è©¦ç’°å¢ƒé©—è­‰å®Œæˆ
  - [ ] åŠŸèƒ½æ——æ¨™é…ç½®æ­£ç¢º
  
- [ ] **æ–‡æª”æ›´æ–°**
  - [ ] ä»»å‹™ç‹€æ…‹æ¨™è¨˜å®Œæˆ [x]
  - [ ] API æ–‡æª”æ›´æ–°
  - [ ] éŒ¯èª¤è¨˜éŒ„æ›´æ–°ï¼ˆå¦‚éœ€è¦ï¼‰
  
- [ ] **æäº¤æº–å‚™**
  - [ ] Git commit éµå¾ªè¦ç¯„
  - [ ] PR æè¿°æ¸…æ™°å®Œæ•´
  - [ ] CI/CD æª¢æŸ¥é€šé

## ğŸ”„ éŒ¯èª¤è¨˜éŒ„æ ¼å¼

```markdown
## éŒ¯èª¤ä¿®æ­£è¨˜éŒ„ (YYYY-MM-DD) - ä»»å‹™ X.X [Task Name]

### ä½¿ç”¨çš„ Agent Prompt
- Primary: [Agent Name]
- Secondary: [Agent Name]

### TDD é€±æœŸç¸½çµ
- æ¸¬è©¦æ¡ˆä¾‹æ•¸é‡ï¼šX
- é‡æ§‹æ¬¡æ•¸ï¼šY
- æœ€çµ‚è¦†è“‹ç‡ï¼šZ%

### ç’°å¢ƒé…ç½®
- ä½¿ç”¨ç’°å¢ƒï¼š[development/test/staging]
- ç‰¹æ®Šé…ç½®ï¼š[åˆ—å‡º]

### é—œéµæ±ºç­–
- Mock vs æ•´åˆæ¸¬è©¦é¸æ“‡
- æ¶æ§‹æ¨¡å¼é¸æ“‡
- æ•ˆèƒ½å„ªåŒ–ç­–ç•¥

### å•é¡Œèˆ‡è§£æ±º
1. **å•é¡Œæè¿°**
   - éŒ¯èª¤è¨Šæ¯
   - ç™¼ç”Ÿç’°å¢ƒ
2. **è§£æ±ºæ–¹æ¡ˆ**
   - å…·é«”æ­¥é©Ÿ
   - ç¨‹å¼ç¢¼ç¯„ä¾‹

### å­¸ç¿’è¦é»
- æœ€ä½³å¯¦è¸
- æ³¨æ„äº‹é …
- å¾ŒçºŒå»ºè­°
```

## âš ï¸ é‡è¦æé†’

1. **TDD ç´€å¾‹**ï¼šåš´æ ¼éµå®ˆå…ˆæ¸¬è©¦å¾Œå¯¦ä½œåŸå‰‡
2. **Agent åˆ‡æ›**ï¼šæ ¹æ“šä»»å‹™å…§å®¹è‡ªå‹•åˆ‡æ›å°æ‡‰ Agent
3. **ç’°å¢ƒéš”é›¢**ï¼šçµ•ä¸æ··ç”¨ä¸åŒç’°å¢ƒçš„é…ç½®
4. **åŠŸèƒ½æ——æ¨™**ï¼šæ‰€æœ‰æ–°åŠŸèƒ½å¿…é ˆå¯æ§åˆ¶é–‹é—œ
5. **æäº¤è¦ç¯„**ï¼šéµå¾ª Conventional Commits æ ¼å¼
6. **æ¸¬è©¦å„ªå…ˆç´š**ï¼šå„ªå…ˆæ•´åˆæ¸¬è©¦ï¼Œå…¶æ¬¡ Mock æ¸¬è©¦
7. **éŒ¯èª¤è™•ç†**ï¼šåªä¿®å¾©ç•¶å‰ä»»å‹™ç›¸é—œçš„éŒ¯èª¤# çµ±ä¸€é–‹ç™¼æµç¨‹æŒ‡å— - TDD + Agent Prompts æ•´åˆç‰ˆ

